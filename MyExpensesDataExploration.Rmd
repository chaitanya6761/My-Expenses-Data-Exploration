---
title: "My Expenses Data Exploration"
output:
  html_document: default
  html_notebook: default
---
## 1. Loading The Datadet
```{r message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)
setwd("E:/MOOC")
expenses <- read.csv("walnut.csv",stringsAsFactors=FALSE)
```

## 2. Dimensions Of The Dataset
```{r}
dim(expenses)
```

## 3. Description of the variables and thier types.
```{r}
str(expenses)
```

## 4. Data Cleaning 
As part of data cleaning, lets remove some unnecessary columns and transform some variables like date and amount from chr variables to date and number variables.  
```{r}
expenses <- subset(expenses,select = -c(NOTE,TIME))
expenses$DATE <- as.Date(expenses$DATE,format='%d-%m-%y')
expenses$MONTH <- as.factor(format(expenses$DATE,'%b'))
expenses$YEAR<- as.factor(format(expenses$DATE,'%Y'))
expenses$PLACE <- as.factor(expenses$PLACE)
expenses$ACCOUNT <- as.factor(expenses$ACCOUNT)
expenses$EXPENSE <- as.factor(expenses$EXPENSE)
expenses$CATEGORY <- ifelse(expenses$CATEGORY == "","UNKNOWN",expenses$CATEGORY)
expenses$CATEGORY <- as.factor(expenses$CATEGORY)
expenses$TAGS <- as.factor(expenses$TAGS)
expenses$AMOUNT <- as.numeric(gsub(",","",expenses$AMOUNT))
str(expenses)
```

## 5. Expense Variable And Total Expenses:
The expense varaiable has mainly two values, YES and NO, if the values is YES, the record can be counted as expense.
```{r}
summary(expenses$EXPENSE)
```
Now Lets transform our expenses dataset so that it includes only those records, that can be counted as expenses.
```{r}
expenses <- subset(expenses,expenses$EXPENSE == "Yes")
```
  
#### The Total Amount Of Money Spend Till Date:
```{r}
sum(expenses$AMOUNT)
```
#### The Total Amount Spent By Year:
```{r}
with(expenses,by(AMOUNT,YEAR,sum))
```
## 6. Category Varaiable :
The category variable captures the diiferent type of categories I spend in.
```{r}
levels(expenses$CATEGORY)
```
Now lets calculate category wise spends:
```{r warning=FALSE}
expenses <- subset(expenses,YEAR == "2017")
expenses_by_category <- expenses %>% 
  group_by(CATEGORY)%>%
  summarize(total=sum(AMOUNT),n = n())%>%
  arrange(desc(total))

expenses_by_category
```

```{r}
ggplot(data=arrange(expenses_by_category,total),aes(x=CATEGORY,y=total))+
  geom_bar(stat="identity",color="black",fill="#F4511E")+
  geom_text(aes(label=total), hjust=-0.2) +
  coord_flip()+
  scale_y_continuous(breaks = seq(0,101000,25000),limits = c(0,109000))+
  labs(y="AMOUNT SPENT",x="DIFFERENT CATEGORIES")+
  theme(axis.text=element_text(size=10),axis.title=element_text(size=14,face="bold"))
```

## 7. Month Varaible:
In this section I will be exploring my month wise expenses.
```{r}
expenses$MONTH <- factor(expenses$MONTH,ordered = TRUE, levels = c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"))
expenses_by_month <- expenses %>% 
  group_by(MONTH) %>%
  summarize(total = sum(AMOUNT),n=n())

expenses_by_month
```

```{r}
ggplot(data=expenses_by_month,aes(x=MONTH,y=total))+
  geom_bar(stat="identity",color="black",fill="#F4511E")+
  geom_text(aes(label=total), vjust=-1.4) +
  labs(y="AMOUNT SPENT",x="DIFFERENT MONTHS")+
  scale_y_continuous(breaks = seq(0,65000,10000),limits = c(0,62000))+
  geom_hline(yintercept = 20000,linetype=2,size=0.9,color="black")+
  theme(axis.text=element_text(size=12),axis.title=element_text(size=14,face="bold"))
```








